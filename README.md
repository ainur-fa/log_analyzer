Анализатор логов nginx
===================================================

Описание
------------
Скрипт обрабатывает при запуске последний, со самой свежей датой в имени лог, в результате работы генерирует отчет в формате html.
Допустимый формат логов - plain и gzip.

Использование
------------
```
log_analyzer.py --config <конфигурационный файл>
```

Конфигурация
------------
Файл конфигурации может содержать следующие поля
```
REPORT_SIZE  - количество URL'ов с наибольшим суммарным временем обработки
REPORT_DIR  - каталог для генерируемых отчетов
LOG_DIR - каталог с лог файлами nginx
ANALYZER_LOG = путь до файла с логом работы анализатора
```
При отсутствии пераданного конфигурационного файла используется дефолтное значение `--config settings.ini`.
Если файл settings.ini отсутствует, анализатор завершит работу с ошибкой. В случае пустого файла, будут использованы параметры по умолчанию:
```
config = {
    "REPORT_SIZE": 1000,
    "REPORT_DIR": "./reports",
    "LOG_DIR": "./log"
}
```
Параметры указанные в конфигурационном файле имеют приоритет.

Пример конфигурационного файла:
-------------------------------
~~~
[config]
REPORT_SIZE = 1000
REPORT_DIR = ./reports
LOG_DIR = ./log
ANALYZER_LOG = log_analyzer.log
~~~

Отображаемые данные в отчете
-----------------------------------------------
~~~
count - сколько раз встречается URL, абсолютное значение
count_perc - сколько раз встречается URL, в процентнах относительно общего числа запросов
time_sum - суммарный $request_time для данного URL'а, абсолютное значение
time_perc - суммарный $request_time для данного URL'а, в процентах относительно общего $request_time всех запросов
time_avg - средний $request_time для данного URL'а
time_max - максимальный $request_time для данного URL'а
time_med - медиана $request_time для данного URL'а
~~~

Совместимость
-------------
Python 3.6 +

Тесты
-------------
Для запуска тестов требуется установка pytest
```
pip install pytest
```

Запуск
```
pytest tests/
```